# 2026-01-27｜荣誉墙 / 生长记录 / 成绩分析：子账号可见性

## 目标
- 子账号在「荣誉墙 / 生长记录 / 成绩分析」页面中：
  - 能看到“自己创建的内容”
  - 也能看到“主账号创建的记录”
- 行为与「小成长」页面保持一致（主账号创建的记录对子账号可见）。

## 现状排查
- 定位三类页面对应的前端页面与服务层请求。
- 定位后端对应路由、handler、service、repository 的查询条件，确认是否仅按 `user_id = 当前登录用户` 过滤。
- 对照「小成长」的实现，确认其“家庭范围（主账号 + 子账号）”的取数逻辑与复用点。

## 方案设计
- 引入/复用“家庭范围（Family Scope）”取数：查询时使用 `user_id IN (root_id, child_ids...)`。
- 对于三类资源：
  - 列表/详情：按家庭范围查询
  - 统计/分析：统计口径基于家庭范围
- 确保创建记录时仍以实际创建者的 `user_id` 写入（不改写归属），只调整读取范围。

## 实施步骤
1. 复用或新增服务方法：获取当前用户的家庭成员 ID 列表（含主账号与子账号）。
2. 将荣誉墙、生长记录、成绩分析相关查询改为家庭范围过滤。
3. 前端对接保持不变或按返回结构微调（字段与接口保持一致）。
4. 本地验证：主账号/子账号分别登录，检查三页面数据可见性与统计口径。

## 验证标准
- 子账号登录：
  - 能看到子账号自己创建的记录
  - 能看到主账号创建的记录
  - 不应看到非本家庭的记录
- 主账号登录：
  - 仍能看到主账号创建的记录（如原本可见）
  - 如需求允许，也能看到子账号创建的记录（与家庭范围一致）
- 前端 TypeScript 类型检查、Lint 通过；接口响应结构 `{ code, message, data }` 不变。

## 风险与回滚
- 风险：统计口径变化导致历史展示差异。
- 回滚：保留原按 `user_id` 过滤的实现分支（通过开关或快速 revert 变更点）。

