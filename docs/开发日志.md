## 技巧总结

- 太好啦，我使用 netlify 部署了前端，使用自己服务器 docker 部署了后端，成功跑起来啦！
- 回退到某个版本：`git reset --hard f3a86385a1c057bde0b4ca34a7dbc0c194095497 `。
- 使用 `git push -f origin af8dd56cb8d2e1460659e1892ad41a3617d4092c:main` 命令将本地回退后的代码强制推送到远程仓库。
- 使用 Python 的`secret`模块生成一个随机的 SECRET_KEY，用于 Flask 应用的加密,`python -c "import secrets; print(secrets.token_hex(16))" `。
- 在`frontend\src\config\app-info.json`文件中设置软件版本信息。
- 后端内置内置 CORS 支持：`backend\internal\config\config.go`文件中设置数据库路径、存储根目录、端口、GIN 模式、是否同步父账号金币,26 行配置了跨域，允许 `https://recordgo.netlify.app` 域名访问，同时在`docker-compose.yml`中设置了`ALLOW_ORIGINS`。
- 后端修改时，GitHub 发布release，触发GitHub Action 自动构建Docker镜像，后端服务需要更新。
- 仅前端修改时，推送到GitHub，然后在Netlify项目页面（`https://app.netlify.com/projects/recordgo/overview`）重新构建，即可更新前端。

## TODO

- 多账号切换
- 重复类型新增：“单次完成终止型”任务

## 20251114 开发日志

- 
- 新增功能：点击任务页面左上角头像，可以实现切换用户、添加新用户、退出登陆。点击任务页面左上角头像，切换用户下方可显示多个账户头像及用户名，点击可切换到对应账户、注册新用户修改为“添加新用户”，点击后登陆新用户账号密码，就可以出现在切换用户的下方，点击就可以来回切换不同用户，请具体实现相应的功能。
- 新增功能：点击任务页面右上角统计图标，进入任务统计新页面，有“本周”、“本月”、“本年”、“全部”三个tab页面，每个页面可以展示对应“本周”或“本月”的总任务数、已完成、平均完成率、总时长、日均时长、总金币数，图表：每日时间分布（分类维度，柱状图）、分类时间占比（环形占比图）。
- 番茄钟页面，开始、完成按钮合并为一个圆形的大图标，图标内显示文字，第一次点击图标开始计时，再次点击图标暂停，长按图标2s完成任务
- 苹果手机chrome浏览器，番茄钟设置已启用“保持常亮”，但番茄钟计时时，屏幕常亮不起作用。
- 完成任务时，庆祝效果粒子在任务附近显示，不要从天而降。
- 今天是11月14日，页面显示“今日任务”，当用户点击11月15日日期是，“今日任务”显示为“11月15日任务”
- 日时长上方图标颜色加粗，下方数字加粗并且颜色与上方图标颜色一致，其他“任务数”、“日金币”、“完成率”也按同样方法修改。
- 项目支持PWA，移动端浏览器打开网站，添加到桌面图标，点击图标可以直接打开网站，但是左上方显示了绿色的底纹，与项目主体底纹颜色不一致，请修改一致。
- “创建任务”图标增大0.5倍。移动端，创建任务页面，点入输入框，输入框不要自动放大，点击日期选择，不要弹出输入法框。
- 底部导航栏 nav 文字下方再增加文字高度 2 倍的空白。
- 任务页面顶部需要固定。
- 心愿页面顶部左上角显示“兑换心愿”并固定，下一行显示“可用金币”、“领取记录”、“创建心愿”按钮，取消下方的“心愿”。
- 我的页面顶部左上角增加标题“我的”，并固定标题行。

## 20251112 开发日志

- 子账号管理页面标题左侧需要显示返回图标和子账号图标，与编辑个人信息页面类似。
- 子账号不可以编辑个人信息，隐藏“编辑个人信息”按钮，隐藏。
- 子账号管理权限中增加 设置权限：“番茄钟设置”、“任务设置”、“金币设置”、“朗读设置”，无此权限按钮点不开，仅查看权限“任务设置”、“金币设置”不可以用。
- 子账号日金币、总金币、可用金币需要和主账号保持一致。
- 把子账号权限编辑改造成“勾选式”的可视化表单（模块/动作粒度），为令牌展示增加失效策略。
- 点击"我的“页面“子账号管理”，进入子账号管理页面，包含子账号列表、创建子账号。
  子账号列表显示创建的子账号，可以修改子账号（头像、昵称及权限）、删除子账号
  创建子账号时，需要输入子账号的头像、昵称，并选择子账号的权限，点击生成 token，生成一个随机的 token，用于子账号登录。
  子账号勾选了下面哪些权限，登录账号后才有对应的按钮或权限，权限包含：
  - 任务权限：创建任务、编辑任务、删除任务、备注任务、完成任务（点击任务复选框，标记任务为已完成状态）。
  - 心愿权限：创建心愿、编辑心愿、删除心愿、兑换心愿。
  - 账号管理权限：编辑个人信息、子账号管理。
    请对应修改上述权限相关函数，实现子账号管理功能；修改登录页面，用户可直接使用 token 登录子账号，无需输入密码。

## 20251111 开发日志

- 在应用的"我的"页面中，点击"关于"按钮，页面内容需包含以下要素：

1. 软件名称：明确软件图标“frontend\src\assets\favicon\android-chrome-192x192.png”（大小合适）、显示"任务积分助手"
2. 版本号：从指定的 JSON 配置文件中读取当前版本号并显示，确保开发人员可通过修改 JSON 文件更新版本号，用户可直观查看应用的当前版本信息
3. "关注小红书"按钮：点击后应使用系统默认浏览器或应用内浏览器跳转到指定的小红书账号页面
4. "邮件联系"按钮：点击后应触发邮件客户端，自动填写收件人为terlun@foxmail.com，方便用户直接发送邮件联系。
   关于页面的设计应保持与应用整体风格一致，布局合理，各元素间距适当，确保在不同屏幕尺寸下均有良好的显示效果和用户体验。

- 为番茄钟计时器添加分钟分割线和数字刻度，在计时器表盘上添加白色分钟分割线（每分钟一条）和数字刻度（每 5 分钟一个），提升时间显示的精确度和可读性。同时调整系统时间显示的样式使其与标题字号一致。加粗表盘轨道和进度条宽度，调整刻度线长度。**时钟环**与**进度环**加粗。
- 右上系统时间显示，以及表盘按“60 分钟满圈”的刻度与比例。
- 修改番茄钟页面背景色为（ 48, 48, 46），时钟颜色（184,206,232），其他按钮一并调整，使得页面颜色整体协调，为夜间主题，让用户可以更专注。页面需要响应式布局，适应不同页面大小，下方的任务标题、备注、预计时长也修改，融入到上方页面。
- 用户进入番茄钟页面后，点击开始计时，手机或平板设备需保持常亮，可通过调用浏览器的 Wake Lock API 来实现这一功能。
- 番茄钟计时时，锁屏后番茄钟继续计时，不中断。

## 20251110 开发日志

- 我的页面，学科设置修改为“任务分类设置”，可以添加、修改、删除任务分类；可以设置任务分类的颜色。任务页面任务分类的颜色和设置一致；创建任务页面、编辑任务页面中的任务分类下拉选项和任务分类设置中分类一致。
- 分类筛选仅显示当日实际存在的分类，含颜色圆点。
- “任务分类设置”页补充排序交互（拖拽）并联动 setOrder。
- 在“我的”页面，“任务设置”中增加“任务自动排序”选项，默认开启，开启后任务页面中任务清单中，任务分类下方的任务中，已完成任务排到下方；当该任务分类都完成时，将未完任务的任务分类排到上方。
- 学科设置中，已添加到学科，可以拖拽排序，调整顺序后，任务清单中显示的顺序也会改变，与排序后的科目顺序一致。
- “任务”页面今日任务右侧筛选图标的右侧新增一个排序图标，点击有“默认排序”、“时间顺序”、“任务分类”、“完成优先”、“添加时间”5 中排序，点击可以实现对应的对任务排序。
- “我的”页面任务设置中增加开启/关闭任务备注的功能，默认是开启的，点击关闭后，任务清单中任务卡片不显示备注图标、菜单栏也不显示备注按钮。
- 实现下拉页面刷新数据。
- 有备注信息的任务，朗读小喇叭图标左侧新增一个备注图标，点击可以查看、回复备注，每条备注有个小喇叭，点击可以播放该备注内容。
- 任务卡片番茄钟图标左侧新增一个小喇叭朗读任务的图标，点击可以播放任务内容，播放内容为："{任务分类}，{任务标题},备注：{任务描述}"，例如：语文，认 2 个汉字，备注：洪恩识字认识 2 个新汉字。小喇叭声音播放使用 SpeechSynthesis，用户可以在“我的”页面朗读设置中进行相关设置，例如：选择朗读语音(中文语音、英文语音)、调整朗读语速、音调等。
- 任务页面，任务卡片中，任务标题需要和任务描述左对齐，并靠近任务复选框一些，现在距离有些远。
- 当新建的任务重复类型为每天、每个工作日、每周、每月时，点击其他日期，可以显示出重复的任务，但是日期下方的紫色小点和当日任务个数没有显示。
- 当新建的任务重复类型为每天、每个工作日、每周、每月时，点击任务菜单，删除任务时，删除对话框需包含“仅删除当前日程”、“删除当前及未来全部日程”、“删除所有日程”；当任务重复类型为无时，删除任务时，删除对话框需仅包含“取消”和“确定”。

## 20251109 开发日志

- 心愿页面点击创建心愿，进入独立的创建心愿页面，页面左上角有个返回图标，点击返回。页面需响应式布局，移动端单列显示，桌面端根据页面调整中为多列显示，，提升不同设备上的显示效果，领取鸡柳页面也是同样的修改。
- 点击兑换按钮，优化弹出的对话框样式，标题栏需要有背景色、界面圆角，使用 tailwend css 美化，更漂亮些。
- 任务页面点击添加任务，进入独立的创建任务页面，页面左上角有个返回图标，点击返回。页面需响应式布局，移动端单列显示，桌面端根据页面调整中为多列显示，，提升不同设备上的显示效果，编辑任务、番茄钟页面也是同样的修改。

## 20251105 开发日志

- 1、创建任务页面中新增 任务图片，用户可以上传该任务对应的 1 张或多张图片到 backend\storage\uploads\images\task_images，上传的图片显示缩略图、可以删除，可以点击查看
  2、分类和计划时长放到同一行
  3、任务页面中新增 重复类型，可以选择：无、每天、每个工作日、每周、每月；当选择每周时，下方可以再次选择周一、周二。。。周日，可多选，选择重复的任务对应重复日期需要创建对应任务。重复类型默认 是 无。
  4、创建任务页面标题前方增加一个图标，页面中每个字段左侧都添加一个图标，如该字段是必填，其右侧显示一个红色的。

## 20251104 开发日志

- 前端安装依赖：cd g:\Code\RecordGo\frontend ; npm install
- 前端启动：cd g:\Code\RecordGo\frontend ; npm run dev 或 pnpm dev
- 后端依赖安装： cd g:\Code\RecordGo\backend ; go mod tidy
- 后端启动：
- 后端启动调试模式：
- 后端启动: cd g:\Code\RecordGo\backend

```powershell
$env:SECRET_KEY = "dev-secret"; $env:DB_PATH = "storage/database/recordgo.db"; $env:STORAGE_ROOT = "storage"; $env:PORT = "8080"; $env:GIN_MODE = "debug"; go mod tidy; go run ./cmd/server
```

- go run main.go
- 测试账号：用户名：testuser，密码：Testuser123
- 测试子账号：用户名：subtestuser，密码：Subtestuser123
